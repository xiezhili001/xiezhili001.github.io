(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d7a32434"],{"047a":function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"zl-MyAlbum"},[e("el-dialog",{attrs:{title:"上传文件",visible:t.uploadData,width:"30%",center:""},on:{"update:visible":function(a){t.uploadData=a}}},[e("el-form",{ref:"transTdForm",staticClass:"demo-form-inline demo-ruleForm",attrs:{model:t.uploadDataForm,size:"mini"}},[e("el-form-item",{attrs:{label:"分类：","label-width":"108px"}},[e("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:t.uploadDataForm.classify,callback:function(a){t.$set(t.uploadDataForm,"classify",a)},expression:"uploadDataForm.classify"}},t._l(t.options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("el-form-item",{attrs:{label:"上传：","label-width":"108px"}},[e("el-upload",{staticClass:"upload-demo",attrs:{action:"/api/album/upload","on-success":t.uploadSuccess,"before-upload":t.uploadBefore,accept:"image/*"}},[e("el-button",{attrs:{size:"mini",type:"primary"}},[t._v("点击上传")]),e("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传图片，且不超过5000kb")])],1)],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(a){t.uploadData=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.uploadDataSubmit}},[t._v("确 定")])],1)],1),e("div",{staticClass:"block",staticStyle:{"margin-bottom":"8px"}},[t._v("\n    时间：\n    "),e("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",size:"mini","value-format":"yyyy/MM/dd"},on:{change:function(a){return t.imgFilter("reset")}},model:{value:t.date,callback:function(a){t.date=a},expression:"date"}}),t._v("  分类：\n    "),e("el-select",{attrs:{placeholder:"全部",size:"mini"},on:{change:function(a){return t.imgFilter("reset")}},model:{value:t.classify,callback:function(a){t.classify=a},expression:"classify"}},t._l(t.options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),e("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"mini"},on:{click:function(a){t.uploadData=!0}}},[t._v("上传文件")])],1),e("div",{staticClass:"infinite-list-wrapper",staticStyle:{overflow:"auto"}},[e("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.imgFilter,expression:"imgFilter"}],staticClass:"list",attrs:{"infinite-scroll-disabled":"disabled"}},t._l(t.imgList,(function(t,a){return e("el-card",{key:a,staticClass:"box-card list-item"},[e("img",{attrs:{src:t.url,alt:""}})])})),1),t.loading?e("p",{staticStyle:{"text-align":"center"}},[t._v("加载中...")]):t._e(),t.noMore?e("p",{staticStyle:{"text-align":"center"}},[t._v(t._s(t.noMoreData))]):t._e()])],1)},l=[],s={name:"MyAlbum",data:function(){return{uploadData:!1,uploadDataForm:{classify:"",url:""},date:"",classify:"",options:[{value:1,label:"深圳"},{value:2,label:"大学"}],imgList:[],loading:!1,noMore:!0,pageNum:0,pageSize:10,noMoreData:"没有数据"}},computed:{disabled:function(){return this.loading||this.noMore}},methods:{uploadDataSubmit:function(){var t=this;this.uploadDataForm.classify?this.uploadDataForm.url?this.$axios.post("/api/album/add",{classify:this.uploadDataForm.classify,url:this.uploadDataForm.url}).then((function(a){t.uploadData=!1,t.imgFilter("reset")})):this.$messageTips("请选择文件"):this.$messageTips("请选择分类")},uploadSuccess:function(t){this.uploadDataForm.url=t.data.path},uploadBefore:function(t){var a=512e4;if(t.size>a)return this.$messageTips("大小超出限制"),!1},imgFilter:function(t){var a,e,i=this;"reset"==t?(this.noMoreData="没有数据",this.imgList=[],this.pageNum=1):(this.pageNum+=1,this.noMore=!1,this.loading=!0),this.date&&(a=new Date(this.date[0]).getTime(),e=new Date(this.date[1]).getTime(),console.log(a,e)),this.$axios.get("/api/album/list",{params:{pageNum:this.pageNum,pageSize:this.pageSize,startTime:a,endTime:e,classify:this.classify}}).then((function(t){if(0==t.code){i.imgList=i.imgList.concat(t.data.album),i.loading=!1;var a=i.pageNum*i.pageSize;if(0==t.data.total)return;if(t.data.total<=a)return i.noMore=!0,void(i.noMoreData="没有更多了");i.noMore=!1}}))}},components:{},created:function(){this.imgFilter()}},o=s,n=(e("304c"),e("0c7c")),r=Object(n["a"])(o,i,l,!1,null,null,null);a["default"]=r.exports},"304c":function(t,a,e){"use strict";var i=e("6407"),l=e.n(i);l.a},6407:function(t,a,e){}}]);